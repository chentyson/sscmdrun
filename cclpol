netstat -antp | grep ESTABLISHED | awk /tcp.*:1[15].*:[1-9]/'{split($4,ip1,":");split($5,ip2,":");if(ip1[3]=="ffff")print "TCPv6",ip1[4],ip1[5],ip2[4];else print "TCP",ip1[1],ip1[2],ip2[1] }' | sort -k3,4 -n | awk 'BEGIN{count=0} {if(aa!=$3){aa=$3;c1=0;c2=0;bb=""};if(bb!=$4){bb=$4;c1++};c2++;dic[aa]=c1" "c2;count++} END {for(key in dic)print key,dic[key];print "All connection count is:",count}' | sort -k3 -n -r
